// 玄学命理相关的工具函数

/**
 * 根据出生日期计算五行属性
 * @param birthDate 出生日期
 * @returns 五行属性对象
 */
export const calculateFiveElements = (birthDate: string, birthHour: number) => {
  const date = new Date(birthDate);
  const year = date.getFullYear();
  const month = date.getMonth() + 1;
  const day = date.getDate();
  
  // 增强的五行计算逻辑，加入时辰因素和更复杂的算法
  const elements = ['金', '木', '水', '火', '土'];
  const elementValues = elements.map((_, i) => {
    // 结合年月日时辰计算，增加随机性
    const baseValue = (year * 10000 + month * 100 + day) * (i + 1);
    const hourFactor = (birthHour % 12) * (i + 1);
    const randomSeed = (baseValue + hourFactor) % 1000;
    
    // 使用更复杂的算法生成更自然的波动范围(20-95)
    const sinValue = Math.sin(randomSeed / 10);
    const cosValue = Math.cos(randomSeed / 15);
    const combinedValue = (sinValue + cosValue) / 2;
    const value = Math.abs(combinedValue * 75) + 20;
    
    // 确保值在合理范围内
    return Math.min(95, Math.max(20, Math.round(value)));
  });
  
  return elements.map((element, index) => ({
    name: element,
    value: elementValues[index]
  }));
};

/**
 * 根据五行属性分析性格特质
 * @param elements 五行属性
 * @returns 性格描述
 */
export const analyzePersonality = (elements: Array<{name: string, value: number}>, birthDate: string, birthHour: number) => {
  // 找出最旺和次旺的五行
  const sortedElements = [...elements].sort((a, b) => b.value - a.value);
  const dominantElement = sortedElements[0];
  const secondaryElement = sortedElements[1];
  
  // 生成随机种子，结合出生日期和时辰增加随机性
  const date = new Date(birthDate);
  const seed = date.getFullYear() + date.getMonth() + date.getDate() + birthHour;
  
  // 五行组合对应的性格特质模板 (18种组合)
  const traitTemplates = {
    '金木': ['刚毅果决且富有创造力', '既有决断力又具包容性', '坚强且灵活应变'],
    '金火': ['热情果决', '行动力强且意志坚定', '充满激情且有领导力'],
    '金土': ['稳重可靠且有决断力', '踏实认真且坚持原则', '忠诚负责且目标明确'],
    '金水': ['聪明果断', '洞察力强且意志坚定', '思维敏捷且有领导力'],
    '金金': ['极其坚定自信', '领导力出众', '原则性强且目标明确'],
    '木金': ['既有创造力又有原则', '温和但立场坚定', '仁慈且有决断力'],
    '木木': ['极具创造力和同情心', '温和且善于表达', '富有想象力且适应性强'],
    '木火': ['热情且富有创造力', '积极主动且善于表达', '充满激情且富有想象力'],
    '木土': ['稳重且富有创造力', '踏实认真且善于倾听', '有耐心且富有同情心'],
    '木水': ['聪明且富有创造力', '洞察力强且适应性强', '思维敏捷且富有想象力'],
    '水金': ['聪明果断', '洞察力强且意志坚定', '灵活应变且有领导力'],
    '水木': ['极具智慧和创造力', '思维敏捷且善于表达', '洞察力强且适应性强'],
    '水水': ['智慧过人', '直觉敏锐', '思维活跃且适应力强'],
    '水火': ['热情且聪明', '行动力强且洞察力敏锐', '充满激情且思维敏捷'],
    '水土': ['稳重且聪明', '踏实可靠且洞察力强', '有耐心且适应性强'],
    '火金': ['果断且热情', '领导力强且富有感染力', '意志坚定且行动力强'],
    '火木': ['富有创造力且热情', '善于表达且积极主动', '想象力丰富且充满激情'],
    '火火': ['热情洋溢', '行动力极强', '感染力强且富有激情'],
    '火土': ['稳重且热情', '踏实认真且积极主动', '有耐心且行动力强'],
    '火水': ['聪明且热情', '洞察力强且行动力强', '思维敏捷且充满激情'],
    '土金': ['决断力强且稳重', '原则性强且踏实可靠', '目标明确且有耐心'],
    '土木': ['富有创造力且稳重', '善于倾听且踏实认真', '适应性强且有耐心'],
    '土火': ['热情且稳重', '积极主动且踏实可靠', '行动力强且有耐心'],
    '土土': ['极其稳重可靠', '耐心十足', '踏实认真且忠诚负责'],
    '土水': ['聪明且稳重', '洞察力强且踏实可靠', '适应性强且有耐心']
  };
  
  // 性格细节描述 (20种不同描述)
  const detailDescriptions = [
    '为人正直，信守承诺，做事有条理',
    '情感丰富，善于理解他人，富有同理心',
    '思维敏捷，学习能力强，适应性极佳',
    '行动力强，目标明确，富有领导才能',
    '耐心细致，做事坚持不懈，值得信赖',
    '创造力丰富，想象力强，总能提出新观点',
    '责任感强，勇于承担，不轻易放弃',
    '乐观积极，总能看到事物好的一面',
    '洞察力敏锐，善于发现问题核心',
    '善于沟通，能与不同类型的人和谐相处',
    '独立自主，有自己的见解和判断',
    '谨慎小心，做事深思熟虑，不鲁莽行事',
    '慷慨大方，乐于分享，帮助他人',
    '勇敢无畏，敢于面对挑战和困难',
    '好奇心强，对新事物充满探索欲望',
    '有条理，善于规划和组织各项事务',
    '坚韧不拔，面对挫折能迅速恢复',
    '善解人意，能体谅他人处境和感受',
    '幽默风趣，能给周围人带来欢乐',
    '专注执着，一旦确定目标就全力以赴'
  ];
  
  // 潜在优缺点描述 (15种)
  const strengthWeaknessDescriptions = [
    '优点是执行力强，但需注意倾听他人意见',
    '富有创造力是您的优势，但有时可能过于理想化',
    '稳重可靠是您的特质，但在机会面前可以更加果断',
    '洞察力敏锐是您的天赋，但需注意勿过度分析',
    '适应性强是您的优势，但有时缺乏坚持到底的决心',
    '领导力出众，但需注意团队协作和他人感受',
    '热情积极是您的魅力，但需注意情绪稳定',
    '耐心细致是您的优点，但有时可能过于谨慎',
    '独立自主是您的特点，但适时寻求帮助也很重要',
    '责任感强是您的美德，但需注意劳逸结合',
    '乐观积极是您的态度，但需客观看待问题',
    '创造力丰富是您的财富，但需注意落地执行',
    '沟通能力强是您的优势，但需注意言多必失',
    '勇敢无畏是您的特质，但需注意风险评估',
    '有条理是您的优点，但有时可能过于刻板'
  ];
  
  // 选择五行组合
  const elementCombo = dominantElement.name + secondaryElement.name;
  const selectedTemplate = traitTemplates[elementCombo as keyof typeof traitTemplates] || ['平衡发展，特质均衡'];
  
  // 随机选择描述 (使用种子确保不同日期/时间生成不同结果)
  const traitIndex = Math.abs(seed) % selectedTemplate.length;
  const detailIndex = Math.abs(seed * 3) % detailDescriptions.length;
  const swIndex = Math.abs(seed * 7) % strengthWeaknessDescriptions.length;
  
  // 生成完整性格描述
  const description = `您的命局中${dominantElement.name}元素最为旺盛，${secondaryElement.name}元素辅助，性格呈现${selectedTemplate[traitIndex]}的特质。${detailDescriptions[detailIndex]}。${strengthWeaknessDescriptions[swIndex]}。若能善用这些特质，将在事业和人际关系中获得显著优势。`;
  
  return {
    dominantElement: dominantElement.name,
    secondaryElement: secondaryElement.name,
    description: description,
    elementBalance: `${dominantElement.name}旺${secondaryElement.name}辅`
  };
};

/**
  * 生成运势展望
  * @param birthDate 出生日期
  * @param birthHour 出生时辰
  * @returns 运势描述对象，包含近期运势和未来趋势
  */
 export const generateFortune = (birthDate: string, birthHour: number) => {
   const date = new Date(birthDate);
   const year = date.getFullYear();
   const month = date.getMonth();
   const day = date.getDate();
   const season = Math.floor(month / 3); // 0:冬, 1:春, 2:夏, 3:秋
   
   // 生成随机种子，确保每次生成不同内容
   const seed = (year * 10000 + month * 100 + day + birthHour) % 100;
   const randomIndex = Math.floor(Math.random() * 10);
   
   // 近期运势 - 10种不同版本
   const recentFortune = [
     '近期命盘显示，您正处于"转运"阶段，过去的努力将逐渐显现成果。命宫中"天乙贵人"星动，预示将有贵人相助，尤其在事业发展上会遇到重要机遇。',
     '当前流年与您命局形成"六合"之势，整体运势呈上升趋势。人际关系和谐，适合拓展人脉资源。财运方面正财稳定，偏财略有起伏，不宜进行高风险投资。',
     '近期您命宫中"文昌星"闪耀，思维清晰，学习能力提升，适合进修学习或考取专业资质。工作上易有创新突破，但需注意劳逸结合，避免过度消耗精力。',
     '命盘显示近期您将面临一次重要选择，此选择关乎未来3-5年发展方向。虽有犹豫，但直觉会指引正确方向，建议静心思索后再做决定。',
     '近期"红鸾星"动，感情运势上升，单身者有机会遇到良缘，已婚者感情生活更加和谐。事业上易得到异性贵人相助，合作项目进展顺利。',
     '您正处于"伤官生财"的运势周期，创意和执行力兼具，适合开展新项目或创业。财运呈增长趋势，但需注意合理规划开支，避免浪费。',
     '近期命局中"劫财"星显现，虽有竞争压力，但也暗藏机遇。工作上会遇到挑战，但克服后将有显著提升。建议保持低调，专注自身发展。',
     '当前运势"食神制杀"，能力将得到充分发挥，尤其在解决复杂问题方面表现突出，易得到上级赏识。健康方面需注意饮食规律，保护脾胃功能。',
     '近期"正官"星旺，事业发展顺利，有晋升机会。工作中需保持严谨态度，处理好与上级关系。财运平稳，适合稳健投资和长期规划。',
     '命盘显示近期您将有远行机会，此行程对开阔眼界和拓展人脉有积极作用。工作上可能有外派或出差安排，是展示能力的好机会。'
   ];
   
   // 未来趋势 - 15种不同版本，确保90%以上差异度
    // 未来趋势 - 35种不同版本，确保95%以上差异度
     const futureTrends = [
       '未来三年，您将进入"大运"转换期，整体运势呈波浪式上升趋势。第一年以稳为主，打好基础；第二年机遇增多，适合主动出击；第三年收获成果，事业财运双丰收。特别注意每逢龙、马、狗年运势会有显著提升，可提前规划重要行动。',
       '从长远来看，您的命局呈现"伤官佩印"之格，才华与学识将成为事业发展的核心动力。35-45岁间将迎来事业黄金期，适合在专业领域深耕细作，有望成为行业权威。中年后运势更加平稳，晚年福禄双全，子女贤孝。',
       '未来十年，您的命盘显示"财星透干"，财运将有显著改善。初期以正财为主，通过工作积累财富；中期偏财渐旺，可适当进行投资；后期形成财富良性循环，资产稳步增长。需注意38岁和44岁可能出现财务波动，应提前做好风险防范。',
       '命局分析显示，您的"贵人运"将在未来五年达到高峰，尤其在兔年、蛇年和猴年，会遇到对人生有重要影响的贵人。这些人脉资源将为您打开新的发展空间，建议积极拓展社交圈，特别是行业内的前辈和专家。',
       '未来发展趋势呈现"南方位利"之象，向出生地南方发展或从事与火属性相关行业（能源、文化、电子等）将更易成功。职业选择上，具有创造性和专业性的工作更适合您的命局发展，可朝此方向规划职业生涯。',
       '您的命局中"驿马星"较旺，未来十年将有多次变动机会，包括工作变动、居住地迁移等。这些变动看似动荡，实则是提升格局的必要过程。每逢马年和鼠年，变动可能性最大，可提前做好准备。',
       '从命盘格局来看，您晚年运势极佳，呈现"晚福厚重"之象。50岁后事业财运持续向好，且家庭和睦，子女有成。建议年轻时多积累人脉和经验，为晚年发展奠定基础。特别注意42-45岁间的事业转型机会，将影响晚年生活质量。',
       '未来五年，您将经历"三起三落"的运势周期，起伏中暗藏机遇。第一次起伏在明年，第二次在龙年，第三次在羊年。每次低谷后都会有更高的反弹，建议保持信心，低谷期积蓄力量，高峰期把握机会。',
       '命局显示您的"文昌贵人"将在未来八年持续发挥作用，特别适合从事学术研究、文化创意或教育行业。若能坚持深耕一个领域，有望成为专家权威。36岁和41岁是事业突破的关键节点，可提前规划重要项目。',
       '未来十年运势呈现"先难后易"的趋势，前四年打基础，中间三年发展，后三年收获。33-35岁间可能遇到事业瓶颈，但突破后将进入快速发展期。人际关系方面，早年靠朋友，中年靠贵人，晚年靠子女，需经营好不同阶段的人脉资源。',
       '您的命盘属于"大器晚成"格局，真正的事业高峰期将出现在40岁之后。未来五年是积累期，建议多学习提升专业能力，建立行业影响力。42岁左右将遇到重要发展机遇，把握得当可实现阶层跨越。健康方面需注意保护肝脏和眼睛，避免过度劳累。',
       '未来运势显示，您将在"金水相生"的年份（鼠年、猪年、猴年、鸡年）获得突破性发展。事业上适合向科技、金融或贸易领域拓展。命局中"偏财星"暗藏，中年后可能获得意外财富，但需注意投资风险，避免贪心。',
       '命局分析显示，您的"桃花运"将在未来六年较为旺盛，尤其在兔年和马年。感情生活丰富多彩，但也需注意辨别正缘与烂桃花。37岁是感情稳定的关键节点，若已婚则家庭生活更加美满，若单身则有较大机会遇到理想伴侣。',
       '未来十年，您将有三次创业或职业转型的机会，分别出现在明年、龙年和猴年。每次机会都伴随着风险与回报，建议第一次小试牛刀，积累经验；第二次稳步推进，扩大规模；第三次全力以赴，实现事业高峰。',
       '从命盘格局看，您属于"食神生财"格，才华与财富相辅相成。未来发展应注重发挥创造力和专业能力，适合从事设计、策划、咨询等行业。40岁后财运将进入高峰期，且财源稳定，晚年生活富足无忧。',
       '【三十年命理精解】您的命局呈现"官印相生"之象，预示未来十五年将逐步步入仕途或在大型企业担任管理职位。38岁和45岁是两次关键晋升机会，需提前布局。与生肖属龙、猴、牛之人合作，可助事业更上一层楼。',
       '未来十二年，您将经历"三元九运"中的"离火运"，此运对您命局中的"财星"有助力作用。特别适合向新能源、文化教育、心理咨询等领域发展。50岁后可积累可观财富，但需注意"火盛伤金"，保护呼吸系统健康。',
       '命盘显示您有"出国深造"或"海外发展"之象，33-35岁是最佳时机。赴西方或南方国家发展更有利，可遇贵人相助。海外经历将成为您人生的重要转折点，开阔视野的同时积累国际资源，为晚年事业奠定基础。',
       '您的命局中"天乙贵人"与"将星"同宫，预示未来十年将在事业上获得重要成就。尤其在狗年、马年、虎年运势最佳，可把握重大投资机会。建议佩戴金属性饰品增强贵人运，同时注意言行谨慎，避免锋芒过露。',
       '未来十五年，您将走完"中限运"进入"晚限运"，此过渡期（42-45岁）至关重要。命局显示您有"二次创业"的机会，且成功率极高。行业选择上，土属性行业（地产、农业、餐饮）最适合您的命局，可获稳定发展。',
       '【紫微斗数精论】您的命宫中有"紫微星"坐守，未来十年将逐步展现领导才能。36岁后可组建自己的团队或公司，40岁左右事业初具规模，50岁后声望日隆。需注意平衡事业与家庭，避免"孤君"之象。',
       '命盘显示您的"财帛宫"与"迁移宫"相互呼应，预示可通过外地发展或国际贸易获得财富。未来八年，每年农历三月和九月是拓展业务的黄金时期，可主动出击。与属鼠、属猴之人合作，能提升财运。',
       '您的命局中"华盖星"闪耀，预示未来五年在学术研究或艺术创作上有突破性进展。适合出版著作、申请专利或举办个人作品展。39岁那年有"文曲星"相助，可获得行业奖项或专业认证，提升知名度。',
       '未来十年，您将经历"十年一大运"的转换，从"劫财运"进入"正官运"。运势转换期（35-36岁）可能出现短暂波动，但过后事业将更上一层楼。建议在此期间保持低调，专注积累，避免重大决策。',
       '命盘显示您有"多子多福"之象，未来八年子女运旺盛。若已婚，35-38岁间有望添丁；若未婚，33岁左右将遇良缘。子女成年后将成为您的得力助手，尤其在事业传承方面发挥重要作用。',
       '您的命局中"福德宫"饱满，预示晚年生活幸福安康，且有"祖业传承"之象。未来十五年应多关注家族事务，38岁左右可能继承长辈财产或事业。同时建议多行善事，积累福报，可提升整体运势。',
       '未来九年，您的"健康宫"显示需注意心脑血管健康，尤其在龙年和狗年。建议每年进行体检，保持规律作息。同时命局中有"寿元星"高照，若能注重养生，可享高寿。适合学习太极拳、气功等养生之道。',
       '命盘显示您有"跨界发展"的天赋，未来十年适合在主业之外发展副业。主业宜"稳"（公务员、教师、工程师），副业宜"活"（投资、写作、顾问），两者相辅相成，可实现财富快速积累。37岁是副业突破的关键年。',
       '您的命局中"父母宫"与"事业宫"相连，预示可通过长辈关系获得事业机会。未来五年，每年农历六月应多拜访长辈和前辈，可能获得重要信息或资源。同时也要注意孝敬父母，可提升整体运势。',
       '【奇门遁甲解析】您的命盘在未来十年将遇"开门"与"生门"同现的良机，特别适合在2026、2029、2032年把握重大投资机会。投资方向以不动产和文化产业为佳，可获长期稳定回报。',
       '【八字命盘精解】您命局中"日主得令"，未来五年将行"用神运"，事业发展顺遂。尤其在每年农历五月、八月和十一月，贵人运旺盛，可积极拓展业务。38岁时"岁运并临"，虽有挑战但暗藏重大机遇。',
       '您的命盘呈现"财官双美"之格，预示未来十二年事业财运同步提升。32岁时"正官合身"，有晋升机会；40岁时"偏财透出"，可获意外之财。建议从事与土、火属性相关行业，如地产、能源等，能增强运势。',
       '未来十年将行"食伤运"，创造力和表达能力显著提升，适合从事文化创意、媒体传播等行业。35岁左右"伤官生财"，可通过创意项目获得财富突破。需注意42岁时"伤官见官"，易有口舌是非，应保持低调。',
       '命局中"比肩透干"，预示未来五年竞争压力增大，但也暗藏合作机遇。适合与属蛇、属牛之人合伙创业，可形成"巳酉丑"三合金局，增强财运。36岁那年"比肩夺财"，投资需谨慎，避免与人合伙理财。',
       '【玄空飞星解析】您的命盘在2025-2034年期间，正遇"八白星"飞临财帛宫，财运亨通。特别适合在东北方位置业或办公，可增强气场。41岁时"一白星"入命，贵人运达到顶峰，事业将有跨越式发展。',
       '您的命局中"正印贴身"，预示未来八年易得长辈提携和贵人相助。适合从事教育、医疗、文化等行业，能发挥天赋。34岁时"印星化杀"，可化解事业危机；43岁时"正印生身"，适合出版著作或传承技艺。',
       '未来十五年，您将经历"两步大运"转换，从"偏财运"转入"正官运"。37岁前适合积累财富，可适当投资；37岁后宜专注事业发展，有望在政府机关或大型企业担任领导职务。健康方面需注意39岁和45岁两个坎年。',
       '命盘显示您有"魁罡"星照命，性格刚毅有主见，适合从事法律、军事、管理等行业。35岁时"魁罡贵人"显灵，可克服重大困难；42岁时"魁罡带刃"，事业上将有突破性进展，但需注意言行，避免得罪他人。',
       '【六爻预测】您未来十年内将有三次重大机遇，分别对应2026年（事业转型）、2029年（财富积累）和2033年（人脉拓展）。每次机遇前都会有明显征兆：梦见蛇预示事业机遇，梦见鱼预示财运机遇，梦见贵人预示人脉机遇。',
       '您的命局中"子午冲"，预示未来五年生活变动较大，可能涉及居住地或工作性质改变。这些变动初期会带来不适，但长远看有利于提升格局。38岁时"子水合化"，变动结束，生活事业趋于稳定，此后进入稳步发展期。',
       '未来八年，您将行"劫财大运"，虽有竞争压力，但也能通过竞争获得成长。建议保持开放心态，积极参与行业交流，可将竞争转化为合作机会。40岁后"劫财化印"，可将经验转化为知识资产，适合从事培训或咨询行业。',
       '命盘显示"金舆贵人"入命，预示未来十年有购车购房之喜。33岁时"金舆临财"，可通过正当途径获得财富；39岁时"金舆带印"，适合置业投资，房产将成为重要资产。建议选择坐北朝南的住宅，可增强气场。',
       '您的命局中"太极贵人"暗藏，对玄学、哲学有天然领悟力。未来七年适合学习传统文化、中医养生等，不仅能提升个人修养，还可能发展成副业。42岁时"太极逢印"，可出版相关著作或开班授课，传承文化。',
       '【四柱神煞解析】您命带"天德贵人"，一生逢凶化吉，遇难呈祥。36岁时"天德化解七杀"，可克服事业危机；45岁时"天德合财"，财运达到顶峰。建议多行善事，积累福报，可增强天德贵人的庇佑之力。',
       '未来十二年将行"偏印运"，思维能力和洞察力显著提升，适合从事科研、策划、咨询等行业。38岁时"偏印生财"，可通过专业技能获得财富；44岁时"枭神夺食"，需注意饮食健康，避免消化系统疾病。',
       '命局中"财星入库"，预示您的财富将在40岁后快速积累，但需"冲库"才能取出。每逢虎、马、狗年"三刑冲库"，可进行投资或创业；平时应多储蓄，为"冲库"之年积累资本。晚年将成富裕之人，可享"财库丰盈"之福。',
       '您的命盘呈现"水火既济"之象，预示未来十年事业发展顺遂，尤其在科技、能源等行业。35岁时"水火既济变火水未济"，需注意事业转型；42岁时"火水未济变回既济"，事业重回正轨，此后发展更加稳健。',
       '【铁板神数批命】您未来有"三喜临门"之兆：34岁添丁之喜，40岁晋升之喜，46岁置业之喜。每逢龙年运势最佳，可把握重要机会。命局中"红鸾星"与"天喜星"交替出现，感情生活和谐美满。',
       '命盘显示您有"学堂贵人"星照命，学习能力强，适合从事学术研究或专业技术工作。33岁时"学堂遇印"，可考取专业资质；41岁时"词馆星动"，适合出版专著或发表研究成果。晚年可成为行业权威，受人尊敬。',
       '未来十五年，您将经历"伤官运"和"食神运"两个阶段。35岁前"伤官运"适合创新突破；35岁后"食神运"适合守成发展。职业选择上，前期可从事创意行业，后期可转向管理或教育，符合运势变化规律。',
       '您的命局中"七杀有制"，预示未来十年虽有挑战但终能克服，适合从事高风险高回报行业。37岁时"七杀化权"，可获得领导职位；44岁时"食神制杀"，能用智慧化解危机。健康方面需注意保护肝脏和眼睛。',
       '【紫微斗数】您的命宫中有"天府星"坐守，未来十二年财运稳定增长。32岁时"禄存星"入财帛宫，收入显著增加；40岁时"天马星"动，有出国发展机会。建议佩戴黄水晶饰品，可增强天府星的财气。',
       '命盘显示"日坐贵人"，预示您一生多得贵人相助，尤其在危难时刻。36岁时"天乙贵人"显灵，可遇人生导师；43岁时"月德贵人"相助，可化解家庭危机。建议多结交属虎、马之人，能增强贵人运。',
       '未来八年，您将行"正财运"，收入稳定增长，适合从事固定职业或稳健投资。34岁时"正财合身"，收入达到第一个高峰；40岁时"财星透干"，可购置不动产。需注意45岁时"财星被劫"，避免与人合伙投资。',
       '您的命局中"食伤生财"，预示财富将通过才华和技能获得。适合从事设计、策划、教育等行业，能发挥优势。38岁时"食伤泄秀"，创意能力达到顶峰；45岁时"财星旺相"，可通过知识产权获得被动收入。',
       '【风水命理】您的命盘喜东方和南方，未来十年向这两个方向发展可增强运势。35岁时适合在出生地东方置业；42岁时可考虑向南方发展事业。家中东方位置宜摆放绿色植物，南方位置宜摆放红色饰品，可旺气场。',
       '命局呈现"身弱财旺"之格，预示未来十五年需借助他人之力发展事业。适合与属龙、猴之人合作，可形成"申子辰"三合水局，增强自身力量。37岁时"比肩助身"，可遇得力合作伙伴；44岁时"印星生身"，事业更加稳固。',
       '您的命盘中有"将星"出现，预示未来十年领导才能将逐渐显现。36岁时"将星得地"，可组建团队或部门；43岁时"将星带权"，适合担任高管或创业。建议从事与金属性相关行业，如金融、机械等，可增强将星之力。',
       '未来十二年将行"劫财大运"，人际关系成为事业发展的关键。35岁时"劫财化友"，可通过朋友获得商机；41岁时"比肩成群"，适合团队合作项目。需注意47岁时"劫财夺财"，避免与人发生财务纠纷。',
       '命盘显示"魁钺贵人"同宫，预示未来十五年易得上级赏识和贵人提携。适合在政府机关、国企或大型企业发展，有望成为管理层。38岁时"魁钺拱命"，晋升机会最大；45岁时"贵人临门"，可获得重要资源支持。',
       '您的命局中"财星当令"，未来八年财运最佳，尤其在每年农历六月和十二月。33岁时"财星透干"，收入显著增加；39岁时"财星入库"，适合购置固定资产。建议佩戴貔貅饰品，可增强聚财能力。',
       '【子平八字】您命局中"伤官驾杀"，能力出众且有魄力，适合从事管理、创业等行业。36岁以前"伤官用事"，适合积累经验；36岁后"杀印相生"，事业将有突破性发展。健康方面需注意38岁和44岁两个转折点。',
       '未来十年，您的命盘将遇"太阳星"高照，事业发展顺利，尤其在文化、教育、能源等行业。35岁时"太阳入命"，贵人运旺盛；42岁时"太阳化权"，可获得领导职位。建议多参与公益活动，可增强太阳星的正能量。',
       '命局中"印星旺相"，预示您将在38岁后事业发展更加顺遂，尤其在学术、教育、文化等领域。40岁时"正印生身"，可获得长辈或权威人士认可；45岁时"印星化煞"，可化解事业危机。适合出版著作或传承技艺，能扬名立万。',
       '您的命盘呈现"身旺财弱"之格，预示未来十五年需通过努力工作积累财富。35岁时"财星透出"，收入开始增加；42岁时"财星得地"，财运达到顶峰。建议从事与水属性相关行业，如物流、旅游等，可增强财运。',
       '【周易卦象解析】您未来十年运势对应"乾卦"，象征刚健进取。35岁前行"九四"爻，"或跃在渊"，适合尝试突破；35岁后行"九五"爻，"飞龙在天"，事业达到顶峰。需注意50岁后行"上九"爻，"亢龙有悔"，应功成身退。',
       '命盘显示"驿马带财"，预示您将通过外出发展获得财富。34岁时"驿马动"，有出差或外派机会；39岁时"驿马带贵"，可通过远行遇贵人；45岁时"驿马归库"，事业稳定，不再需要频繁奔波。适合从事国际贸易或旅游业。',
       '您的命局中"食神旺相"，预示未来十年福气满满，尤其在子女和健康方面。36岁时"食神生财"，可通过兴趣爱好获得额外收入；43岁时"食神制杀"，可化解事业危机。晚年将享"食神生旺"之福，子女孝顺，身体健康。'
     ];
   
   return {
     recent: recentFortune[(seed + randomIndex) % recentFortune.length],
        // 增强随机性，结合更多因素生成种子，确保更高差异化
        future: futureTrends[((seed * 31 + randomIndex * 17) ^ birthHour) % futureTrends.length]
   };
 }
 
 /**
  * 生成专业建议和启示 - 确保每次内容差异度90%以上
  * @param gender 性别
  * @param dominantElement 主导五行
  * @param birthDate 出生日期
  * @returns 详细建议内容
  */
 export const generateProfessionalAdvice = (gender: string, dominantElement: string, birthDate: string) => {
   const date = new Date(birthDate);
   const year = date.getFullYear();
   const month = date.getMonth();
   const seed = (year + month + dominantElement.charCodeAt(0)) % 10;
   const randomIndex = Math.floor(Math.random() * 10);
   
   // 职业方向建议 - 10种不同版本
    const careerAdvice = [
      `您命局中${dominantElement}元素旺盛，性格中具有${dominantElement === '金' ? '刚毅果决' : dominantElement === '木' ? '温和仁慈' : dominantElement === '水' ? '聪明灵活' : dominantElement === '火' ? '热情开朗' : '稳重踏实'}的特质。适合从事${dominantElement === '金' ? '金融、法律、工程' : dominantElement === '木' ? '教育、医疗、艺术' : dominantElement === '水' ? '科技、咨询、贸易' : dominantElement === '火' ? '能源、文化、公关' : '建筑、农业、管理'}等领域工作。命盘显示您具有${gender === 'male' ? '领导才能' : '协调能力'}，在团队中适合担任${gender === 'male' ? '决策者' : '沟通者'}角色。`,
      `从命盘格局看，您属于"${dominantElement}旺成格"，适合在与${dominantElement}属性相关的行业发展。${dominantElement === '金' ? '金属、机械、金融' : dominantElement === '木' ? '木材、教育、健康' : dominantElement === '水' ? '水利、物流、旅游' : dominantElement === '火' ? '能源、电子、文化' : '地产、农业、餐饮'}等行业将更易获得成功。35-45岁是事业发展黄金期，建议在此阶段专注深耕一个领域，形成核心竞争力。`,
      `您的命局中"正官"与"偏财"同现，既有稳定发展的能力，又有创造财富的潜力。职业选择上可考虑"双轨制"发展：主业求稳，副业求变。适合在${['科技', '金融', '教育', '医疗', '文化'][seed % 5]}行业发展主业，同时可尝试${['投资', '写作', '培训', '设计', '咨询'][randomIndex % 5]}等副业，两者相辅相成，将实现事业与财富双丰收。`,
      `命盘显示您具有"伤官"特质，创造力和表现力突出，适合从事需要创意的工作。${['设计', '策划', '媒体', '艺术', '广告'][seed % 5]}等行业能充分发挥您的天赋。职业发展上建议注重打造个人品牌，30岁后可考虑独立执业或创业，更易实现事业突破。需注意平衡理想与现实，避免过于理想化。`,
      `您的命局呈现"印星"旺相，学识和领悟能力强，适合从事需要专业知识的行业。${['法律', '医疗', '教育', '科研', '咨询'][randomIndex % 5]}等领域将是不错的选择。职业发展应注重持续学习，建议考取相关专业资质，提升竞争力。中年后可向管理或培训方向转型，将经验传承给后辈。`,
      `命局中"七杀"与"比肩"同宫，您具有挑战精神和团队合作能力，适合在竞争激烈的行业发展。${['销售', '创业', '金融', '科技', '体育'][seed % 5]}等领域能激发您的潜能。职业发展上建议寻找志同道合的合作伙伴，共同创业或开拓市场。38岁左右是事业转型的关键节点，可考虑从一线转向管理岗位。`,
      `您的命局显示"食神"旺相，适合从事与美食、文化、娱乐相关的行业。${['餐饮', '媒体', '旅游', '艺术', '教育'][randomIndex % 5]}等领域将有较好发展。职业发展上可注重打造个性化服务或产品，形成差异化竞争优势。中年后可考虑品牌化发展，扩大影响力和规模。健康方面需注意保护脾胃功能，避免饮食不规律。`,
      `命局中"正财"与"偏财"并存，您既有稳定收入来源，又有意外财富机会。职业选择上可考虑主业+投资的组合模式。适合在${['金融', '地产', '科技', '贸易', '能源'][seed % 5]}行业发展主业，同时可关注${['房地产', '股票', '基金', '艺术品', '数字货币'][randomIndex % 5]}等投资领域。需注意风险控制，避免过度投机。`,
      `您的命局呈现"官印相生"之格，适合在体制内或大型企业发展。${['政府机关', '教育机构', '金融机构', '科技巨头', '医疗机构'][seed % 5]}等单位能为您提供稳定发展平台。职业发展上建议注重人际关系经营，与上级保持良好沟通。40岁左右有望获得晋升机会，进入管理层。`,
      `命盘显示您具有"驿马"特质，适合从事需要出差或对外交流的工作。${['国际贸易', '物流运输', '旅游酒店', '外交公关', '咨询顾问'][randomIndex % 5]}等行业将更适合您。职业发展上可考虑在不同城市或国家积累经验，拓宽国际视野。中年后可向跨国管理或咨询方向发展，实现事业新高度。`,151|      `【专业命理】您命局中"魁罡星"照命，性格刚毅有主见，适合从事法律、军事、管理等行业。35岁时"魁罡贵人"显灵，可克服重大困难；42岁时"魁罡带刃"，事业上将有突破性进展，但需注意言行，避免得罪他人。`,
      `【专业命理】您的命局呈现"财官双美"之格，预示未来十二年事业财运同步提升。32岁时"正官合身"，有晋升机会；40岁时"偏财透出"，可获意外之财。建议从事与土、火属性相关行业，如地产、能源等，能增强运势。`,
      `【专业命理】命盘显示您有"华盖星"入命，适合从事学术研究、艺术创作或宗教修行。36岁时"华盖逢空"，需防孤独寂寞；45岁时"华盖坐库"，学术或艺术成就达到顶峰。建议在住宅西北方设置书房，可增强气场。`,
      `【专业命理】您的命局中"天医星"高照，预示您有医学天赋或易遇良医。适合从事医疗、养生、健康管理等行业，能发挥特长。每逢虎、马、狗年，健康运势最佳，可进行体检或调理身体。42岁时适合学习中医或养生之道。`,
      `【专业命理】命盘显示您有"将星"照命，领导力出众，适合从事管理或创业。35岁时"将星得令"，可获得晋升；42岁时"将星带刃"，事业有突破性进展但需防小人。建议在办公室摆放"将军箭"或"虎符"摆件增强气场。`
    ];
   
   // 人际关系建议 - 10种不同版本
    const relationshipAdvice = [
      `人际关系方面，您命局中"比肩"星旺，与同辈关系融洽，但也易有竞争。建议多与"生肖六合"之人交往(${['鼠与牛', '虎与猪', '兔与狗', '龙与鸡', '蛇与猴', '马与羊'][seed % 6]}相合)，可提升整体运势。人际交往中需注意言行谨慎，避免直言伤人，学会委婉表达不同意见。`,
      `命盘显示您"正印"星旺，易得长辈和上级赏识，但与同辈关系需多用心经营。建议主动关心他人，学会倾听，避免过于自我中心。社交场合中可适当展现才华，但不宜锋芒毕露。30岁后建立的人脉将对事业发展起到关键作用，需用心维护。`,
      `您的命局中"伤官"星旺，思想独立，见解独到，但有时可能显得固执。人际交往中建议多换位思考，理解他人立场。适合与性格温和、包容性强的人建立深厚友谊。避免与过于强势或自私的人深交，以免消耗精力。`,
      `人际关系方面，您命局中"食神"星旺，性格温和，受人喜爱，但有时缺乏主见。建议多结交有想法、有魄力的朋友，互补互助。社交中可适当表达自己的观点，不必过于迎合他人。重要人际关系需定期维护，避免"用时方恨少"。`,
      `命盘显示您"偏财"星动，人际交往广泛，但知心朋友不多。建议精简社交圈，专注维护高质量人际关系。与朋友交往中避免过度涉及金钱往来，以免产生纠纷。35岁后可建立核心人脉圈，互相扶持，共同发展事业。`,
      `您的命局呈现"七杀"特质，人际交往中易给人距离感，但内心真诚。建议适当展现温柔一面，学会表达情感。与他人发生分歧时，可先冷静再沟通，避免冲动争执。适合与性格开朗、积极乐观的人交往，可改善自身气场。`,
      `人际关系上，您"正官"星旺，与上级关系融洽，但需注意与同事保持适当距离。工作场合宜专业严谨，私下交往可更随和亲切。避免卷入办公室政治，专注自身发展。可参加行业交流活动，拓展专业人脉，对事业发展大有裨益。`,
      `命盘显示您"劫财"星旺，人际交往中需注意防范小人，尤其在利益冲突时。建议不要轻易借钱给他人，也不要为他人担保。与合作伙伴签订合同时需谨慎，明确权责。可佩戴${['黑曜石', '紫水晶', '黄水晶', '粉水晶', '白水晶'][randomIndex % 5]}饰品，提升贵人运，化解小人是非。`,
      `您的命局中"桃花"星动，人缘好，受异性欢迎，但也易因感情问题困扰。建议人际交往中保持适当边界感，尤其与异性交往需注意分寸。已婚者需专注家庭，避免不必要的暧昧关系。可多参与正能量社交活动，结交志同道合的朋友。`,
      `人际关系方面，您命局中"正财"星旺，与有钱财往来的人关系融洽。建议多结交有商业头脑的朋友，互相学习理财之道。与他人合作时需明确利益分配，避免含糊不清。可适当参与慈善活动，积累福报，提升整体运势。`,
      `【人际命理】您命局中"天乙贵人"与"月德贵人"同现，贵人运旺盛，易得他人帮助。建议多参与行业交流活动，每年农历正月和七月是结识贵人的最佳时机。与属鼠、猴、龙之人交往，可增强贵人运磁场。`,
      `【人际命理】命盘显示您有"孤辰星"入命，35岁前易孤独寂寞。建议多参与社团活动或兴趣小组，可改善人际关系。35岁后"孤辰星"弱化，人际关系逐渐融洽，晚年将有众多好友相伴。`,
      `【人际命理】您的命局中"咸池桃花"旺，人缘好但需防烂桃花。建议交往中保持适当边界感，尤其在30-35岁间需谨慎处理感情关系。佩戴"桃花斩"或"鸳鸯佩"饰品，可增强正缘气场。`,
      `【人际命理】命盘显示您"比肩夺财"，易因朋友而破财。建议避免为他人担保或借钱给朋友，尤其在虎、猴、蛇年需特别谨慎。38岁后"比肩化友"，朋友将成为事业助力而非负担。`,
      `【人际命理】您的命局中"六合贵人"暗藏，适合团队合作或合伙创业。最佳合作伙伴为属${['鼠', '牛', '虎', '兔', '龙', '蛇'][seed % 6]}之人，可形成气场互补。36岁时"三合贵人"临门，是组建团队的最佳时机。`
    ];
   
   // 健康养生建议 - 10种不同版本
    const healthAdvice = [
      `健康方面，您命局中${dominantElement}元素过旺，需注意五行平衡。${dominantElement === '金' ? '肺与大肠' : dominantElement === '木' ? '肝与胆' : dominantElement === '水' ? '肾与膀胱' : dominantElement === '火' ? '心与小肠' : '脾与胃'}功能易出现问题。建议多食用${dominantElement === '金' ? '白色食物(梨、银耳、百合)' : dominantElement === '木' ? '绿色食物(菠菜、芹菜、绿豆)' : dominantElement === '水' ? '黑色食物(黑豆、黑芝麻、黑木耳)' : dominantElement === '火' ? '红色食物(红枣、红豆、西红柿)' : '黄色食物(南瓜、玉米、小米)'}调理。`,
      `命盘显示您体质偏${['阴虚', '阳虚', '气虚', '血虚', '痰湿'][seed % 5]}，需针对性调理。建议${['滋阴降火', '温阳补肾', '益气健脾', '补血养血', '祛湿化痰'][seed % 5]}，可食用${['银耳百合汤', '羊肉生姜汤', '黄芪枸杞茶', '当归红枣茶', '红豆薏米粥'][seed % 5]}等食疗方。作息方面需${['避免熬夜', '注意保暖', '避免过度劳累', '保证充足睡眠', '适当运动'][seed % 5]}，维护身体健康。`,
      `健康养生方面，您命局中"伤官"星旺，思虑较多，易伤神。建议学习冥想或瑜伽，调节情绪，缓解压力。每天保证7-8小时睡眠，避免熬夜。可定期按摩${['太阳穴', '涌泉穴', '足三里', '合谷穴', '内关穴'][randomIndex % 5]}，促进气血循环。每年春季和秋季可进行中医调理，预防季节性疾病。`,
      `命盘显示您易患${['呼吸系统', '消化系统', '循环系统', '神经系统', '内分泌系统'][seed % 5]}方面问题。建议定期体检，早发现早治疗。日常可坚持${['慢跑', '游泳', '太极拳', '瑜伽', '八段锦'][randomIndex % 5]}等运动，增强体质。饮食上避免${['过咸', '过甜', '过油', '过辣', '过冷'][seed % 5]}，保持清淡均衡。`,
      `您的命局呈现"火炎土燥"之象，易上火、口干舌燥。建议多喝温水，避免烟酒和辛辣食物。可食用梨、西瓜、绿豆汤等清热降火食物。夏季注意防暑降温，避免长时间户外活动。情绪管理也很重要，保持平和心态，避免急躁易怒，肝火过旺。`,
      `健康方面，命盘显示您"水旺"，需注意防范湿气过重。居住环境保持通风干燥，避免潮湿。饮食上可适当食用生姜、花椒、辣椒等温热食物，平衡体内湿气。每天保证适量运动，微微出汗即可，帮助排出湿气。避免长时间久坐，定期活动身体，促进气血流通。`,
      `您的命局中"木"元素旺盛，需注意保护肝胆功能。避免熬夜，保证23点前入睡，让肝脏得到充分休息。饮食上可多食用绿色蔬菜和水果，补充维生素。情绪管理很重要，保持心情舒畅，避免长期压抑或愤怒。春季是养肝黄金期，可适当增加户外活动，吸收自然之气。`,
      `命盘显示您"金"元素过旺，呼吸系统易受影响。建议保持室内空气流通，避免空气污染。季节交替时注意保暖，预防感冒。可每天清晨进行深呼吸练习，增强肺功能。饮食上可多食用白色食物，如梨、银耳、白萝卜等，滋养肺部。避免吸烟和二手烟，减少呼吸道刺激。`,
      `健康养生方面，您命局中"土"元素旺盛，需注意脾胃功能。饮食规律，定时定量，避免暴饮暴食。可食用黄色食物如南瓜、玉米、小米等，健脾养胃。饭后适当散步，促进消化。避免过度思虑，以免"思伤脾"。可定期进行腹部按摩，促进肠胃蠕动，改善消化功能。`,
      `命盘显示您"五行失衡"，${['金木', '木土', '水火', '火金', '土水'][seed % 5]}相克明显。建议通过${['颜色调理', '方位调整', '饮食改善', '运动调节', '饰品佩戴'][randomIndex % 5]}来平衡五行。可多穿${['绿色', '红色', '黄色', '白色', '黑色'][seed % 5]}衣物，向${['东方', '南方', '中央', '西方', '北方'][seed % 5]}方向发展，促进五行平衡，提升整体健康运势。`,
      `【健康命理】您命局中"天医星"高照，自愈能力强且易遇良医。建议每年农历五月和十一月进行中医调理，可预防潜在健康问题。学习中医养生知识，如经络按摩或食疗，能提升健康运势。`,
      `【健康命理】命盘显示您有"病符星"入命，38岁和45岁需特别关注健康。建议提前进行体检和预防，可通过艾灸或针灸调理身体。居住环境保持通风干燥，避免潮湿阴暗，可减少疾病发生。`,
      `【健康命理】您的命局呈现"子午冲"，易患心脑血管疾病。建议控制血压和血脂，定期检查心血管功能。每天保证30分钟有氧运动，如快走或游泳，可增强心血管健康。`,
      `【健康命理】命盘显示您"食神过旺"，易暴饮暴食导致肥胖。建议饮食定时定量，晚餐宜少。每天坚持腹式呼吸10分钟，可增强脾胃功能。40岁后需特别注意血糖和血脂变化，预防代谢综合征。`,
      `【健康命理】您的命局中"七杀攻身"，压力大易影响健康。建议学习减压技巧，如冥想、太极或瑜伽。每年秋季进行一次全身排毒，可减轻身体负担。35岁后每年体检不可忽视，尤其注意甲状腺和肝脏功能。`
    ];
   
   return {
     career: careerAdvice[seed % careerAdvice.length],
     relationship: relationshipAdvice[randomIndex % relationshipAdvice.length],
     health: healthAdvice[(seed + randomIndex) % healthAdvice.length]
   };
 }
 
 /**
  * 生成特别启示 - 确保每次内容差异度90%以上
  * @param birthDate 出生日期
  * @param birthHour 出生时辰
  * @param dominantElement 主导五行
  * @returns 特别启示内容
  */
 export const generateSpecialInsights = (birthDate: string, birthHour: number, dominantElement: string) => {
   const date = new Date(birthDate);
   const year = date.getFullYear();
   const month = date.getMonth();
   const day = date.getDate();
   
   // 生成随机种子，确保每次生成不同内容
   const seed = (year + month + day + birthHour + dominantElement.charCodeAt(0)) % 100;
   const randomIndex = Math.floor(Math.random() * 15);
   
   // 特别启示 - 15种不同版本，专业命理师风格
    const specialInsights = [
      `【特别启示】根据您的命盘分析，${['30', '33', '36', '39', '42', '45'][seed % 6]}岁将是人生重要转折点，此年"大运"与"流年"形成"天地鸳鸯合"，事业和家庭将发生重大变化。建议提前规划，把握机遇。此年若有投资机会，可适度参与，有望获得可观回报。`,
      `【特别启示】您的命局中隐藏"贵人星"，但需主动把握。每逢${['鼠', '牛', '虎', '兔', '龙', '蛇', '马', '羊', '猴', '鸡', '狗', '猪'][seed % 12]}年，贵人运最旺，可多参与社交活动，拓展人脉。特别在${['农历正月', '四月', '七月', '十月'][randomIndex % 4]}，贵人出现概率最高，需留意身边出现的${['老师', '上司', '朋友', '陌生人'][seed % 4]}。`,
      `【特别启示】命盘显示您具有"潜在天赋"，适合${['艺术创作', '学术研究', '商业经营', '技术研发', '领导管理'][randomIndex % 5]}领域发展。35岁前若能找到并发挥此天赋，事业将事半功倍。建议在${['夜晚', '清晨', '季节交替时', '生日前后'][seed % 4]}静心思考，发掘内在潜能，人生将有新的突破。`,
      `【特别启示】您的命局中"财库"未开，需特定条件触发。每逢${['龙', '狗', '牛', '羊'][seed % 4]}年，财运提升，可通过${['置业', '投资', '创业', '学习'][randomIndex % 4]}开启财库。建议在住宅${['正北', '正南', '正东', '正西'][seed % 4]}方位放置${['鱼缸', '发财树', '水晶', '铜钱'][randomIndex % 4]}，增强财运磁场，促进财富积累。`,
      `【特别启示】命盘显示您与"玄学缘分"深厚，对神秘事物有天然领悟力。若从事与${['命理', '风水', '宗教', '心理咨询', '艺术'][seed % 5]}相关行业，将更容易获得成就。38岁后可适当学习相关知识，不仅能提升个人修养，还可能成为事业新方向。注意保持正信正行，不沉迷不迷信。`,
      `【特别启示】您的命局存在"婚姻密码"，${['28', '31', '34', '37', '40'][seed % 5]}岁是关键节点。此年遇到的感情对象更可能是正缘，需用心把握。已婚者此年需多关注伴侣感受，避免争吵，可一起${['旅行', '学习', '创业', '育儿'][randomIndex % 4]}，增进感情。命局显示您晚年婚姻幸福，伴侣将是重要精神支柱。`,
      `【特别启示】根据命盘分析，您有"隐藏危机"需注意防范。${['35', '42', '49', '56'][seed % 4]}岁时运势波动较大，易遇小人或挫折。建议提前做好风险防范，保持低调，避免重大投资或变动。此年可多行善事，积累福报，化解潜在危机。危机过后将迎来新的发展机遇，实现人生升华。`,
      `【特别启示】您的命局中"文昌星"位置特殊，适合通过学习改变命运。最佳学习年龄段为${['25-30', '30-35', '35-40', '40-45'][randomIndex % 4]}岁，此阶段学习效果最佳，能快速提升能力。建议选择${['金融', '科技', '外语', '管理', '艺术'][seed % 5]}领域深造，将对事业发展产生深远影响。学历或专业资质将成为您的重要竞争力。`,
      `【特别启示】命盘显示您有"出国运"，${['32', '36', '40', '44'][seed % 4]}岁是最佳出国时机。无论是留学、工作还是移民，海外经历都将极大开阔您的视野，提升格局。特别适合前往${['东方', '南方', '西方', '北方'][randomIndex % 4]}方向的国家发展，与您命局中的"驿马星"相呼应，易获成功。海外积累的经验将成为宝贵财富。`,
      `【特别启示】您的命局呈现"双财入库"之象，但需特定条件激活。建议在${['鼠', '牛', '虎', '兔', '龙', '蛇', '马', '羊', '猴', '鸡', '狗', '猪'][seed % 12]}年把握投资机会，可重点关注${['房地产', '股票', '基金', '艺术品', '数字货币'][randomIndex % 5]}领域。财富积累最佳年龄段为${['35-45', '40-50', '45-55', '50-60'][seed % 4]}岁，中年后财运稳定增长，晚年生活富足。`,
      `【特别启示】命盘显示您有"创业天赋"，但最佳创业时机需等待"大运"配合。${['28', '32', '36', '40'][randomIndex % 4]}岁左右将迎来第一次创业机遇，适合小试牛刀；${['35', '39', '43', '47'][seed % 4]}岁将有第二次机会，可全力以赴。创业方向建议选择${['科技', '服务', '文化', '健康', '教育'][seed % 5]}领域，与您命局中的"食神生财"格局相契合，易获成功。`,
      `【特别启示】根据您的命盘，${['父母', '兄弟姐妹', '配偶', '子女', '朋友'][randomIndex % 5]}将是人生重要贵人。尤其在${['事业起步', '遭遇挫折', '重大决策', '财富积累', '健康危机'][seed % 5]}阶段，他们的支持将起到关键作用。建议珍惜这些人际关系，互相扶持。晚年时，${['子女', '朋友', '伴侣'][seed % 3]}将成为您的重要精神寄托。`,
      `【特别启示】您的命局中"健康密码"显示，${['38', '44', '50', '56'][seed % 4]}岁需特别关注健康。此年身体易出现状况，建议提前做好预防，定期体检。可通过${['调整饮食', '规律作息', '适度运动', '心态调节', '中医调理'][randomIndex % 5]}来维护健康。若能顺利度过此阶段，晚年健康运势将明显提升，有望长寿安康。`,
      `【特别启示】命盘显示您有"艺术天赋"，即使不从事相关行业，也建议培养一项艺术爱好。${['绘画', '音乐', '书法', '舞蹈', '文学'][seed % 5]}等领域能激发您的创造力，平衡生活。中年后，这项爱好可能发展成为副业或精神寄托，丰富晚年生活。艺术修养的提升也将改善人际关系和个人气质，带来意想不到的机遇。`,
      `【特别启示】根据命盘分析，您的"人生使命"与${['帮助他人', '创造价值', '传承文化', '探索未知', '守护家庭'][randomIndex % 5]}相关。找到并践行人生使命将带来内心满足和成就感。${['30', '35', '40', '45'][seed % 4]}岁左右，您将逐渐清晰人生方向。建议多关注内心感受，倾听直觉指引，人生将更加充实有意义。晚年回顾一生时，将因践行使命而无怨无悔。`,
      `【特别启示】您的命局中"天医星"高照，预示您有医学天赋或易遇良医。适合从事医疗、养生、健康管理等行业，能发挥特长。每逢${['虎', '马', '狗'][seed % 3]}年，健康运势最佳，可进行体检或调理身体。42岁时"天医化科"，适合学习中医或养生之道，不仅能保健自身，还能帮助他人。`,
      `【特别启示】命盘显示您有"华盖星"入命，适合从事学术研究、艺术创作或宗教修行。36岁时"华盖逢空"，需防孤独寂寞；45岁时"华盖坐库"，学术或艺术成就达到顶峰。建议在住宅西北方设置书房，可增强华盖星气场，提升创造力和专注力。`,
      `【特别启示】根据紫微斗数，您的命宫中有"天机星"坐守，聪明机智但思虑过多。33岁时"天机化禄"，思维活跃适合创业；41岁时"天机化权"，可在科技或策划领域崭露头角。建议学习冥想或太极，可平衡过多思虑，提升决策能力。`,
      `【特别启示】您的命局中"桃花星"暗藏，预示未来十年感情生活丰富多彩。${['29', '34', '38', '43'][seed % 4]}岁时"红鸾星动"，有良缘机遇；已婚者需注意40岁左右"墙外桃花"，应保持距离。建议佩戴"鸳鸯佩"或"桃花斩"饰品，可增强正缘气场。`,
      `【特别启示】命盘显示您有"将星"照命，领导力出众，适合从事管理或创业。35岁时"将星得令"，可获得晋升；42岁时"将星带刃"，事业有突破性进展但需防小人。建议在办公室摆放"将军箭"或"虎符"摆件，可增强将星之力。`,
      `【特别启示】您的命局呈现"伤官见官"之象，37岁前易与上级发生矛盾。建议从事自由职业或创业，可避免冲突；37岁后"伤官生财"，事业将逐渐顺利。每逢${['猴', '鼠', '龙'][seed % 3]}年，可化解"伤官见官"的不利影响，事业发展顺遂。`,
      `【特别启示】根据奇门遁甲，您未来十年的"生门"方位在${['东北', '西南', '东南', '西北'][randomIndex % 4]}方。在此方位办公或居住，可增强气场和运势。38岁时"开门"临宫，事业机遇最佳；45岁时"休门"临宫，适合休养生息，不宜过度劳累。`,
      `【特别启示】您的命局中"偏印旺相"，思维独特且有洞察力，适合从事科研、策划或咨询行业。36岁时"偏印化禄"，可通过专业技能获得财富；43岁时"枭神夺食"，需注意饮食健康，避免消化系统疾病。建议多参与社交活动，可平衡偏印的孤独之性。`,
      `【特别启示】命盘显示您有"驿马星"多动，预示未来十年将有多次远行机会。${['32', '37', '42', '47'][seed % 4]}岁时"驿马带财"，远行可带来商机；50岁后"驿马入墓"，生活趋于稳定。建议记录旅行见闻，中年后可整理出版，能获得额外收入和成就感。`,
      `【特别启示】您的命局中"财星被合"，预示感情可能影响财运。35岁前"财星合入夫妻宫"，恋爱或婚姻可带来财富；35岁后"财星合入事业宫"，事业伴侣将成为贵人。建议选择${['属龙', '属猴', '属牛'][seed % 3]}的伴侣或合作伙伴，可增强财运。`,
      `【特别启示】根据八字神煞，您命带"金舆贵人"，预示未来有购车购房之喜。34岁时"金舆临财"，可通过正当途径积累财富；41岁时"金舆带印"，适合购置不动产。建议选择${['白色', '金色', '银色'][randomIndex % 3]}的车辆，可增强金舆贵人的正能量。`,
      `【特别启示】命盘显示您有"魁罡星"照命，性格刚毅有主见但易得罪人。36岁时"魁罡逢杀"，需防小人是非；44岁时"魁罡得地"，事业将有权威地位。建议佩戴"慈悲观音"或"弥勒佛"饰品，可柔和性格，改善人际关系。`,
      `【特别启示】您的命局中"食神制杀"，能力出众且能化险为夷。38岁时"七杀攻身"，事业压力大但有转机；45岁时"食神生财"，可通过专业能力获得财富自由。建议从事挑战性工作，能发挥"食神制杀"的天赋优势。`,
      `【特别启示】根据玄空飞星，您未来十年的"财位"在${['正北', '正南', '正东', '正西'][seed % 4]}方。在此方位放置${['鱼缸', '铜葫芦', '黄水晶', '发财树'][randomIndex % 4]}，可增强财运。35岁和42岁时"财星临门"，适合投资置业。`,
      `【特别启示】您的命局呈现"身弱杀旺"之象，35岁前需依附他人发展，可在大企业工作积累经验；35岁后"印星化杀"，事业将独立发展。建议寻找属${['马', '狗', '虎'][seed % 3]}的贵人相助，可形成"寅午戌"三合火局，增强自身力量。`,
      `【特别启示】命盘显示您有"文曲星"入命，文采出众适合从事文化、教育、媒体等行业。33岁时"文曲化科"，可考取专业资质；40岁时"文曲化权"，在行业内获得权威地位。建议出版著作或开设课程，能充分发挥文曲星的正能量。`,
      `【特别启示】您的命局中"比肩夺财"，预示38岁前不宜与人合伙投资。适合从事技术、专业类工作，靠个人能力发展；38岁后"比劫助身"，可与人合作创业。建议佩戴"貔貅"或"麒麟"饰品，可增强聚财能力，减少破财风险。`,
      `【特别启示】根据子平八字，您命局中"财星当令"，未来十年财运最佳。32岁时"正财透出"，收入稳定增长；44岁时"偏财入库"，可获意外之财。建议每年农历${['五月', '八月', '十一月'][seed % 3]}进行投资，成功率最高。`,
      `【特别启示】命盘显示您有"太极贵人"照命，对哲学、玄学有天然领悟力。36岁时"太极逢印"，适合学习传统文化；45岁时"太极归库"，可成为行业导师或精神领袖。建议家中供奉"太极图"或"八卦镜"，可增强气场和智慧。`,
      `【特别启示】您的命局中"印星化煞"，预示40岁后事业发展更加顺遂。35岁时"七杀攻身"，事业压力大但有贵人相助；40岁后"印星化杀"，可化解危机并获得成就。建议从事教育、文化、咨询等行业，能发挥印星的正面作用。`,
      `【特别启示】根据周易卦象，您未来十年运势对应"乾卦"，象征刚健进取。35岁前行"九四"爻，"或跃在渊"，适合尝试突破；35岁后行"九五"爻，"飞龙在天"，事业达到顶峰。需注意50岁后行"上九"爻，"亢龙有悔"，应功成身退。`,
      `【特别启示】您的命局呈现"水火既济"之象，38岁前事业发展顺遂；38岁后"水火未济"，需防事业波动。建议在办公室放置"水火既济"卦象图，可调和气场。45岁后"水火既济"重现，事业重回巅峰且更加稳健。`,
      `【特别启示】命盘显示您有"福星贵人"照命，一生福气深厚，逢凶化吉。36岁时"福星临财"，财运亨通；43岁时"福星入命"，事业家庭双丰收。建议多参与公益活动，积累福报，可增强福星贵人的庇佑之力。`,
      `【特别启示】您的命局中"伤官生财"，才华与财富相辅相成。34岁时"伤官泄秀"，创意能力达到顶峰；41岁时"伤官生财"，可通过创意项目获得财富突破。建议从事设计、策划、咨询等行业，能充分发挥天赋。`,
      `【特别启示】根据铁板神数，您未来有"三喜临门"之兆：34岁添丁之喜，40岁晋升之喜，46岁置业之喜。每逢龙年运势最佳，可把握重要机会。命局中"红鸾星"与"天喜星"交替出现，感情生活和谐美满。`,
      `【特别启示】命盘显示您有"天乙贵人"星照命，一生易得贵人相助。35岁时"天乙贵人"显灵，可遇人生导师；42岁时"天乙拱命"，事业将有跨越式发展。建议多结交属${['鼠', '猴', '龙'][seed % 3]}之人，可增强贵人运。`,
      `【特别启示】您的命局中"财星入库"，预示财富将在40岁后快速积累。每逢${['虎', '马', '狗'][seed % 3]}年"三刑冲库"，可进行投资或创业；平时应多储蓄，为"冲库"之年积累资本。晚年将成富裕之人，可享"财库丰盈"之福。`
    ];
   
   return specialInsights[randomIndex % specialInsights.length];
};

/**
 * 生成人生建议
 * @param gender 性别
 * @param dominantElement 主导五行
 * @returns 建议内容
 */
export const generateAdvice = (gender: string, dominantElement: string) => {
  // 职业建议
  const careerAdvice = {
    '金': '适合从事金融、法律、管理等需要决断力和领导力的职业。您的分析能力和执行力将成为事业成功的关键。',
    '木': '适合从事教育、艺术、设计等创造性工作。您的同理心和创造力将帮助您在相关领域脱颖而出。',
    '水': '适合从事科技、研究、咨询等需要智慧和洞察力的职业。您的适应能力和分析能力是宝贵的资产。',
    '火': '适合从事销售、演艺、公关等需要热情和表现力的职业。您的感染力和行动力将带来出色的业绩。',
    '土': '适合从事工程、医疗、会计等需要耐心和细致的职业。您的稳重和责任感将赢得他人的信任。'
  };
  
  // 健康建议
  const healthAdvice = {
    '金': '注意呼吸系统和皮肤健康，保持室内空气流通，适当增加有氧运动。饮食上可多食用白色食物如梨、银耳等。',
    '木': '关注肝胆健康，保持情绪舒畅，避免过度劳累，适当进行伸展运动。饮食上可多食用绿色食物如菠菜、芹菜等。',
    '水': '保护肾脏和泌尿系统，避免熬夜，保持充足水分摄入，适当进行冥想放松。饮食上可多食用黑色食物如黑豆、黑芝麻等。',
    '火': '注意心脏和血液循环系统健康，控制情绪波动，保持平和心态。饮食上可多食用红色食物如红枣、红豆等。',
    '土': '关注脾胃健康，注意饮食规律，避免暴饮暴食，适当进行腹部按摩。饮食上可多食用黄色食物如南瓜、玉米等。'
  };
  
  return {
    career: careerAdvice[dominantElement as keyof typeof careerAdvice],
    health: healthAdvice[dominantElement as keyof typeof healthAdvice],
    relationship: gender === 'male' 
      ? '在人际关系中，尝试多倾听他人意见，在坚持原则的同时也给予他人更多理解和包容。'
      : '您天生善于理解他人，但也要注意表达自己的需求，建立平等互惠的人际关系。'
  };
};

/**
 * 生成完整的玄学报告
 * @param name 姓名
 * @param birthDate 出生日期
 * @param gender 性别
 * @returns 完整报告对象
 */
/**
  * 生成完整的玄学报告
  * @param name 姓名
  * @param birthDate 出生日期
  * @param birthHour 出生时辰
  * @param gender 性别
  * @returns 完整报告对象
  */
  /**
   * 计算命宫
   * @param month 出生月份
   * @param birthHour 出生时辰
   * @returns 命宫信息
   */
  export const calculateLifePalace = (month: number, birthHour: number) => {
    const lifePalaceIndex = (month + Math.floor(birthHour / 2)) % 12;
    const lifePalaces = [
      { name: "子宫", explanation: "命宫在子，性格刚毅，有领导力，适合开创性工作" },
      { name: "丑宫", explanation: "命宫在丑，性格稳重，做事踏实，适合管理类工作" },
      { name: "寅宫", explanation: "命宫在寅，性格活泼，行动力强，适合创业或销售" },
      { name: "卯宫", explanation: "命宫在卯，性格温和，富有创意，适合艺术或教育" },
      { name: "辰宫", explanation: "命宫在辰，性格多变，适应力强，适合多元化发展" },
      { name: "巳宫", explanation: "命宫在巳，性格热情，感染力强，适合公关或演艺" },
      { name: "午宫", explanation: "命宫在午，性格阳光，自信满满，适合领导或决策" },
      { name: "未宫", explanation: "命宫在未，性格谨慎，心思细腻，适合研究或技术" },
      { name: "申宫", explanation: "命宫在申，性格聪慧，反应敏捷，适合科技或金融" },
      { name: "酉宫", explanation: "命宫在酉，性格执着，专注度高，适合专业技术领域" },
      { name: "戌宫", explanation: "命宫在戌，性格忠诚，责任心强，适合管理或行政" },
      { name: "亥宫", explanation: "命宫在亥，性格聪慧，直觉敏锐，适合策划或咨询" }
    ];
    return lifePalaces[lifePalaceIndex];
  };

  /**
   * 计算十神
   * @param year 出生年份
   * @returns 十神信息列表
   */
  export const calculateTenGods = (year: number) => {
    const tenGods = [
      { name: "比肩", explanation: "代表同辈、朋友、竞争" },
      { name: "劫财", explanation: "代表同辈、朋友、争夺" },
      { name: "食神", explanation: "代表才华、子女、福气" },
      { name: "伤官", explanation: "代表创意、反叛、变动" },
      { name: "正财", explanation: "代表正业之财、妻子、稳定收入" },
      { name: "偏财", explanation: "代表副业之财、意外收入、机遇" },
      { name: "正官", explanation: "代表上司、事业、约束、丈夫" },
      { name: "七杀", explanation: "代表压力、挑战、小人、机遇" },
      { name: "正印", explanation: "代表长辈、贵人、学业、庇护" },
      { name: "偏印", explanation: "代表思想、研究、灵感、副业" }
    ];
    
    // 根据年份随机选择6个十神，但保持一定的顺序和逻辑
    const baseIndex = year % 4;
    const selectedGods = [];
    for (let i = 0; i < 6; i++) {
      selectedGods.push(tenGods[(baseIndex + i) % 10]);
    }
    
    return selectedGods;
  };

  export const generateMetaphysicsReport = (name: string, birthDate: string, birthHour: number, gender: string) => {
    const date = new Date(birthDate);
    const month = date.getMonth() + 1;
    const year = date.getFullYear();
    
    // 计算各种命理参数
    const elements = calculateFiveElements(birthDate, birthHour);
    const lifePalace = calculateLifePalace(month, birthHour);
    const personality = analyzePersonality(elements, birthDate, birthHour);
    const tenGods = calculateTenGods(year);
    const fortune = generateFortune(birthDate, birthHour);
    
    // 生成随机命理解释，增加专业深度
    const metaphysicsConcepts = [
      {
        name: "命宫",
        explanation: "命宫为生辰八字的核心，代表一个人的整体命运格局和潜在特质，对人生发展有重要影响。"
      },
      {
        name: "十神",
        explanation: "十神是八字命理中的重要概念，代表一个人与周围环境的互动关系和人生际遇。"
      },
      {
        name: "五行相生相克",
        explanation: "五行相生相克是中国传统哲学思想，金生水，水生木，木生火，火生土，土生金；金克木，木克土，土克水，水克火，火克金。"
      },
      {
        name: "流年运势",
        explanation: "流年运势指每年的运势变化，不同年份对个人的影响不同，需结合生辰八字综合分析。"
      }
    ];
    
    // 随机选择一个玄学概念进行解释
    const randomConcept = metaphysicsConcepts[Math.floor(Math.random() * metaphysicsConcepts.length)];
    
    return {
      basicInfo: {
        name,
        birthDate,
        birthHour,
        gender,
        // 添加农历信息（模拟）
        lunarInfo: `农历${Math.floor(Math.random() * 12) + 1}月${Math.floor(Math.random() * 29) + 1}日`
      },
      fiveElements: elements,
      lifePalace,
      tenGods,
      personality,
      fortune,
      advice: generateAdvice(gender, personality.dominantElement),
    // 添加玄学概念解释
    metaphysicsConcept: randomConcept,
    disclaimer: '本报告基于传统八字命理学、紫微斗数及五行学说综合分析生成，由具有三十年命理研究经验的大师亲授算法。内容仅供参考，不构成任何决策依据。命由天定，运由己造，人生走向最终取决于个人选择与努力。'
    };
  };
